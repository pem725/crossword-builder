# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Crossword Builder is an educational crossword puzzle generator that extracts vocabulary from source files (lecture notes, textbooks, code) and produces crossword puzzles with college-level (SAT-level) clues. The primary interface is a Claude Code Skill at `.claude/skills/crossword-from-source/`.

## Commands

```bash
# Install (editable)
pip install -e .

# Install with dev dependencies
pip install -e ".[dev]"

# Run tests
pytest

# Run tests with coverage
pytest --cov=src

# Run grid generator directly
python -m src.crossword.grid_generator
```

## Architecture

The system follows a three-stage pipeline: **extraction → generation → output**.

### Core Modules (`src/crossword/`)

- **`term_extractor.py`** — Extracts terms from natural language text or Python code. Uses frequency-based ranking, stop-word filtering, and length constraints (4-15 chars). Handles CamelCase/snake_case parsing for code identifiers. Returns `ExtractedTerm` dataclasses with term, frequency, and sentence context.

- **`grid_generator.py`** — Places words onto a 2D grid using a backtracking algorithm. Places longest word first (centered), then finds intersections with already-placed words. Falls back to random placement when no intersections exist. Trims empty rows/columns. Handles ASCII rendering (Unicode box chars), numbered clue assignment, and JSON export.

- **`renderers/`** — Multi-format output package. Dispatches via `render()` / `render_all()` with lazy imports.
  - `_base.py` — Shared `RenderConfig` dataclass (colours, fonts, sizes)
  - `png_renderer.py` — Grid → PNG via Pillow (300 DPI, student + answer key)
  - `pdf_renderer.py` — Full worksheet → PDF via fpdf2 (header, grid, clues, answer key page)
  - `html_renderer.py` — Self-contained interactive HTML (inline CSS/JS, localStorage, no CDN)

### Claude Code Skill (`.claude/skills/crossword-from-source/`)

- **`SKILL.md`** — Skill definition with YAML frontmatter; defines the trigger conditions and workflow process
- **`references/clue-guidelines.md`** — Clue difficulty distribution: 60% straightforward, 30% moderate, 10% challenging
- **`references/output-formats.md`** — ASCII grid, JSON, PNG, PDF, and HTML format specifications

### Key Design Decisions

- **Core modules have zero runtime dependencies** — only Python standard library
- **Renderers are optional extras** — `pip install -e ".[render]"` adds Pillow and fpdf2; HTML renderer needs nothing beyond stdlib
- **Python 3.9+** required
- **Clues are generated by Claude**, not algorithmically — the Python code handles grid layout and term extraction only
- Grid uses 180-degree rotational symmetry (standard crossword convention)
- Default grid size is 15×15, scales based on word count
